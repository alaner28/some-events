"use strict";const e=require("../../common/vendor.js"),a=require("../../store/useUserStore.js"),s={__name:"profileset",setup(s){const u=a.useUserStore();e.storeToRefs(u);const{currentUser:l,defaultAvatars:t,meta:n}=e.storeToRefs(u);let o=e.ref("未登录状态"),r=e.ref("0123456789"),i=e.ref(t.value),v=e.ref(""),d=e.ref(""),c=e.ref("");const f=e.reactive({nickname:"",sex:"",name:"",address:""}),m=e.computed((()=>o.value!==f.nickname||v.value!==f.sex||d.value!==f.name||c.value!==f.address));e.onMounted((()=>{l&&(o.value=l.value.nickname,r.value=l.value.uid,i.value=t.value,v.value=l.value.sex,d.value=l.value.username,c.value=l.value.address,f.nickname=l.value.nickname,f.sex=l.value.sex,f.name=l.value.username,f.address=l.value.address,console.log(f),console.log("update successfully"))}));const x=async()=>{if(n.value.isLoggedin)try{const a={nickname:o.value,sex:v.value,username:d.value,address:c.value};await u.updateUserInfo(a),e.index.showToast({title:"保存成功",icon:"success",duration:2e3}),Object.assign(f,a)}catch(a){e.index.showToast({title:"保存失败",icon:"error",duration:2e3}),console.error("保存失败:",a)}else e.index.showToast({title:"请登录",icon:"error",duration:2e3})};function p(){console.log(l)}return(a,s)=>({a:e.o([e=>a.inputVal=e.detail.value,p]),b:a.inputVal,c:e.unref(o),d:e.o((a=>e.isRef(o)?o.value=a.detail.value:o=a.detail.value)),e:e.t(e.unref(r)),f:e.unref(d),g:e.o((a=>e.isRef(d)?d.value=a.detail.value:d=a.detail.value)),h:e.unref(v),i:e.o((a=>e.isRef(v)?v.value=a.detail.value:v=a.detail.value)),j:e.unref(c),k:e.o((a=>e.isRef(c)?c.value=a.detail.value:c=a.detail.value)),l:e.o(x),m:!m.value})}},u=e._export_sfc(s,[["__scopeId","data-v-31d2e159"]]);wx.createPage(u);
